(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41990,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(75225),s=e.i(85183),i=e.i(93230),n=e.i(72526),l=e.i(34239),o=e.i(59559),c=e.i(31195),d=e.i(41891),h=e.i(38814),x=e.i(22787),m=e.i(237),p=e.i(1725),u=e.i(21417),g=e.i(55706),f=e.i(7670),b=e.i(97865),v=e.i(494),j=e.i(94395),y=e.i(44171),N=e.i(46710),w=e.i(31725),M=e.i(27241),R=e.i(61764),F=e.i(75337),P=e.i(89763),C=e.i(43404),S=e.i(51883),T=e.i(29601),k=e.i(18457),V=e.i(22075);class A{constructor(e){var{x:t,y:a}=e;this.xAxisScale=t,this.yAxisScale=a}map(e,t){var a,r,{position:s}=t;return{x:null!=(a=this.xAxisScale.map(e.x,{position:s}))?a:0,y:null!=(r=this.yAxisScale.map(e.y,{position:s}))?r:0}}mapWithFallback(e,t){var a,r,s,i,{position:n,fallback:l}=t;return s="rangeMin"===l?this.yAxisScale.rangeMin():"rangeMax"===l?this.yAxisScale.rangeMax():0,i="rangeMin"===l?this.xAxisScale.rangeMin():"rangeMax"===l?this.xAxisScale.rangeMax():0,{x:null!=(a=this.xAxisScale.map(e.x,{position:n}))?a:i,y:null!=(r=this.yAxisScale.map(e.y,{position:n}))?r:s}}isInRange(e){var{x:t,y:a}=e,r=null==t||this.xAxisScale.isInRange(t),s=null==a||this.yAxisScale.isInRange(a);return r&&s}}function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach(function(t){var r,s,i;r=e,s=t,i=a[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in r?Object.defineProperty(r,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[s]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function E(){return(E=Object.assign.bind()).apply(null,arguments)}function G(e){var t=(0,M.useAppDispatch)();return(0,a.useEffect)(()=>(t((0,w.addLine)(e)),()=>{t((0,w.removeLine)(e))})),null}function I(e){var{xAxisId:t,yAxisId:r,shape:s,className:i,ifOverflow:n}=e,l=(0,F.useIsPanorama)(),o=(0,P.useClipPathId)(),c=(0,M.useAppSelector)(e=>(0,R.selectXAxisSettings)(e,t)),d=(0,M.useAppSelector)(e=>(0,R.selectYAxisSettings)(e,r)),h=(0,M.useAppSelector)(e=>(0,R.selectAxisScale)(e,"xAxis",t,l)),x=(0,M.useAppSelector)(e=>(0,R.selectAxisScale)(e,"yAxis",r,l)),m=(0,N.useViewBox)();if(!o||!m||null==c||null==d||null==h||null==x)return null;var p=((e,t,a,r,s,i,n)=>{var l,o,{x:c,y:d,segment:h,ifOverflow:x}=n,m=(0,j.isNumOrStr)(c);return(0,j.isNumOrStr)(d)?((e,t,a,r,s,i)=>{var{x:n,width:l}=i,o=s.map(e,{position:a});if(!(0,V.isWellBehavedNumber)(o)||"discard"===t&&!s.isInRange(o))return null;var c=[{x:n+l,y:o},{x:n,y:o}];return"left"===r?c.reverse():c})(d,x,r,i,t,a):m?((e,t,a,r,s,i)=>{var{y:n,height:l}=i,o=s.map(e,{position:a});if(!(0,V.isWellBehavedNumber)(o)||"discard"===t&&!s.isInRange(o))return null;var c=[{x:o,y:n+l},{x:o,y:n}];return"top"===r?c.reverse():c})(c,x,r,s,e,a):null!=h&&2===h.length?(o=[(l=new A({x:e,y:t})).mapWithFallback(h[0],{position:r,fallback:"rangeMin"}),l.mapWithFallback(h[1],{position:r,fallback:"rangeMax"})],"discard"===x&&o.some(e=>!l.isInRange(e))?null:o):null})(h,x,m,e.position,c.orientation,d.orientation,e);if(!p)return null;var u=p[0],g=p[1];if(null==u||null==g)return null;var{x:w,y:S}=u,{x:k,y:J}=g,G=O(O({clipPath:"hidden"===n?"url(#".concat(o,")"):void 0},(0,C.svgPropertiesAndEvents)(e)),{},{x1:w,y1:S,x2:k,y2:J}),I=(0,y.rectWithCoords)({x1:w,y1:S,x2:k,y2:J});return a.createElement(T.ZIndexLayer,{zIndex:e.zIndex},a.createElement(b.Layer,{className:(0,f.clsx)("recharts-reference-line",i)},((e,t)=>{var r;if(a.isValidElement(e))r=a.cloneElement(e,t);else if("function"==typeof e)r=e(t);else{if(!(0,V.isWellBehavedNumber)(t.x1)||!(0,V.isWellBehavedNumber)(t.y1)||!(0,V.isWellBehavedNumber)(t.x2)||!(0,V.isWellBehavedNumber)(t.y2))return null;r=a.createElement("line",E({},t,{className:"recharts-reference-line-line"}))}return r})(s,G),a.createElement(v.CartesianLabelContextProvider,E({},I,{lowerWidth:I.width,upperWidth:I.width}),a.createElement(v.CartesianLabelFromLabelProp,{label:e.label}),e.children)))}var D={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:k.DefaultZIndexes.line};function $(e){var t=(0,S.resolveDefaultProps)(e,D);return a.createElement(a.Fragment,null,a.createElement(G,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),a.createElement(I,t))}$.displayName="ReferenceLine";let L=()=>Array.from({length:60},()=>({franchises:0,tier1:0,tier2:0,jv:0})),K=e=>{let t=[],a=2026,r=0;for(let s=0;s<e;s++)t.push(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r]+"-"+a),12==++r&&(r=0,a++);return t},W={franchiseFee:4e4,commissionPerFranchise:1e4,commissionPerTier1:200,commissionPerTier2:500,commissionPerJV:500,overheadMonthly:25e3,overheadSalaryUnit:25e3,overheadCapFranchiseJV:5,overheadCapTier1:15,overheadCapTier2:12,overheadScaleExponent:.8,royaltyRate:.04,platformFeeRate:.0033,tier1Price:1e3,tier2Price:2e3,jvPrice:3500,franchiseMembershipPrice:3500,gmvPerFranchiseMonthly:83333,gmvPerJVMonthly:83333,gmvRampMonths:4,churnRateTier1:.2,churnRateTier2:.1,churnRateJV:.05,churnRateFranchise:.05,materialPctOfGMV:.4,materialMarkup:.1,materialStartMonth:15,materialAdoptionRate:.75,materialRampMonths:4},z={assumptions:W,scenarios:[function(){let e=L();for(let t=3;t<=8;t++)e[t]={franchises:3,tier1:4,tier2:2,jv:0};return e[9]={franchises:1,tier1:3,tier2:1,jv:0},e[10]={franchises:1,tier1:3,tier2:0,jv:0},{name:"Flat 3yr Steady State",startingTier1:3,startingTier2:1,startingJV:1,startingFranchises:0,months:e,color:"#3b82f6"}}(),function(){let e=L();for(let t=3;t<=8;t++)e[t]={franchises:3,tier1:4,tier2:2,jv:0};return e[9]={franchises:1,tier1:3,tier2:1,jv:0},e[10]={franchises:1,tier1:3,tier2:0,jv:0},e[22]={franchises:20,tier1:0,tier2:0,jv:0},e[34]={franchises:20,tier1:0,tier2:0,jv:0},{name:"Expansion Plan",startingTier1:5,startingTier2:2,startingJV:1,startingFranchises:0,months:e,color:"#10b981"}}()],activeScenario:0};function B(e){return e>=0?"$"+Math.round(e).toLocaleString():"($"+Math.abs(Math.round(e)).toLocaleString()+")"}function U(e){let t,a=Math.abs(e);return t=a>=1e6?"$"+(a/1e6).toFixed(1)+"M":a>=1e3?"$"+(a/1e3).toFixed(0)+"K":"$"+Math.round(a).toString(),e<0?"("+t+")":t}function Y(e){return e>=0?"$"+(e/1e6).toFixed(2)+"M":"($"+(Math.abs(e)/1e6).toFixed(2)+"M)"}function H(e){return(100*e).toFixed(1)+"%"}function Q(e){return e.toFixed(1)+"%"}function X(e){return e<=0?0:e>=1?1:1-Math.pow(1-e,1/12)}function Z(e,t,a,r,s){let i=(t+a)/Math.max(1,e.overheadCapFranchiseJV)+r/Math.max(1,e.overheadCapTier1)+s/Math.max(1,e.overheadCapTier2),n=i>0?Math.pow(i,e.overheadScaleExponent):0;return e.overheadMonthly+e.overheadSalaryUnit*n}function q({label:e,value:a,subtext:r,positive:s,negative:i}){return(0,t.jsxs)("div",{className:`rounded-xl p-3 ${i?"bg-red-50 border border-red-200":s?"bg-green-50 border border-green-200":"bg-white border border-gray-200"} shadow-sm overflow-hidden`,children:[(0,t.jsx)("div",{className:"text-[10px] font-medium text-gray-500 uppercase tracking-wide truncate",children:e}),(0,t.jsx)("div",{className:`text-lg font-bold mt-1 truncate ${i?"text-red-600":s?"text-green-600":"text-gray-900"}`,children:a}),r&&(0,t.jsx)("div",{className:"text-[10px] text-gray-400 mt-1 truncate",children:r})]})}function _({label:e,value:a,onChange:r,prefix:s,suffix:i,step:n,min:l,max:o,small:c}){return(0,t.jsxs)("div",{className:c?"flex items-center gap-2":"mb-3",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 whitespace-nowrap",children:e}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-0.5",children:[s&&(0,t.jsx)("span",{className:"text-xs text-gray-400",children:s}),(0,t.jsx)("input",{type:"number",value:a,step:n||1,min:l,max:o,onChange:e=>r(parseFloat(e.target.value)||0),className:`text-xs border border-gray-300 rounded-lg px-2 py-1.5 text-right focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none ${c?"w-20":"w-full"}`}),i&&(0,t.jsx)("span",{className:"text-xs text-gray-400",children:i})]})]})}function ee({title:e,children:r,color:s,collapsible:i,defaultOpen:n}){let[l,o]=(0,a.useState)(!1!==n);return(0,t.jsxs)("div",{className:`border-l-4 ${{blue:"border-blue-500 bg-blue-50/50",green:"border-green-500 bg-green-50/50",amber:"border-amber-500 bg-amber-50/50",red:"border-red-500 bg-red-50/50",purple:"border-purple-500 bg-purple-50/50",indigo:"border-indigo-500 bg-indigo-50/50"}[s||"blue"]} rounded-r-xl p-4 mb-4 shadow-sm`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2 cursor-pointer",onClick:()=>i&&o(!l),children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800",children:e}),i&&(0,t.jsx)("span",{className:"text-gray-400 text-xs",children:l?"â–¾":"â–¸"})]}),l&&r]})}let et=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"],ea=["#3b82f6","#06b6d4","#10b981","#f59e0b","#ef4444","#8b5cf6","#f97316","#ec4899"];function er(){let e,f,b,v,j,y,N,w,M,R,F,P,C,S,T,k,V,A,J,O,E,[G,I]=(0,a.useState)(z),[D,L]=(0,a.useState)("overview"),[er,es]=(0,a.useState)(""),[ei,en]=(0,a.useState)([]),[el,eo]=(0,a.useState)(""),[ec,ed]=(0,a.useState)(null),[eh,ex]=(0,a.useState)(""),em=(0,a.useRef)(null),[ep,eu]=(0,a.useState)(5),[eg,ef]=(0,a.useState)(10),[eb,ev]=(0,a.useState)(5),[ej,ey]=(0,a.useState)(2),[eN,ew]=(0,a.useState)(5),[eM,eR]=(0,a.useState)(2030),{assumptions:eF,scenarios:eP,activeScenario:eC}=G,eS=eP[eC],eT=(e,t)=>I(a=>({...a,assumptions:{...a.assumptions,[e]:t}})),ek=(e,t,a)=>{I(r=>{let s=[...r.scenarios],i=[...s[r.activeScenario].months];return i[e]={...i[e],[t]:Math.max(0,a)},s[r.activeScenario]={...s[r.activeScenario],months:i},{...r,scenarios:s}})},eV=(e,t)=>{I(a=>{let r=[...a.scenarios];return r[a.activeScenario]={...r[a.activeScenario],[e]:t},{...a,scenarios:r}})},eA=e=>{let t={...W,...e.assumptions},a=[e.assumptions?.churnRateTier1,e.assumptions?.churnRateTier2,e.assumptions?.churnRateJV,e.assumptions?.churnRateFranchise].filter(Boolean);return a.length>0&&a.every(e=>e<.04)&&(e.assumptions?.churnRateTier1&&(t.churnRateTier1=1-Math.pow(1-e.assumptions.churnRateTier1,12)),e.assumptions?.churnRateTier2&&(t.churnRateTier2=1-Math.pow(1-e.assumptions.churnRateTier2,12)),e.assumptions?.churnRateJV&&(t.churnRateJV=1-Math.pow(1-e.assumptions.churnRateJV,12)),e.assumptions?.churnRateFranchise&&(t.churnRateFranchise=1-Math.pow(1-e.assumptions.churnRateFranchise,12))),{...e,assumptions:t}},eJ=(e,t)=>{I(a=>{let r=[...a.scenarios],s=[...r[a.activeScenario].months].map(e=>({...e})),i=s.length,n=[];for(let t=0;t<i;t++){let a=t%12;"franchises"===e||"jv"===e?n.push(+(a>=6&&a<=9)):n.push(a>=3&&a<=8?2:1)}let l=n.reduce((e,t)=>e+t,0);if(0===l)return a;let o=n.map(e=>e/l*t),c=o.map(e=>Math.floor(e)),d=t-c.reduce((e,t)=>e+t,0),h=o.map((e,t)=>({i:t,frac:e-c[t]})).filter(e=>e.frac>0).sort((e,t)=>t.frac-e.frac);for(let e=0;e<d&&e<h.length;e++)c[h[e].i]++;for(let t=0;t<i;t++)s[t][e]=c[t];return r[a.activeScenario]={...r[a.activeScenario],months:s},{...a,scenarios:r}})},eO=e=>{if("Tab"!==e.key)return;let t=e.currentTarget,a=parseInt(t.dataset.row||"0"),r=t.dataset.col,s=e.shiftKey?a-1:a+1;if(s<0||s>=eS.months.length)return;let i=document.querySelector(`input[data-row="${s}"][data-col="${r}"]`);i&&(e.preventDefault(),i.focus(),i.select())},eE=(0,a.useMemo)(()=>eP.map(e=>(function(e,t){let a=K(t.months.length),r=t.startingTier1,s=t.startingTier2,i=t.startingJV,n=t.startingFranchises,l=Array(t.startingFranchises).fill(e.gmvRampMonths+1),o=Array(t.startingJV).fill(e.gmvRampMonths+1),c=t.months.map((t,c)=>{let d=t.franchises,h=t.tier1,x=t.tier2,m=t.jv,p=X(e.churnRateTier1),u=X(e.churnRateTier2),g=X(e.churnRateJV),f=X(e.churnRateFranchise),b=Math.floor(r*p),v=Math.floor(s*u),j=Math.floor(i*g),y=Math.floor(n*f);r=Math.max(0,r-b+h),s=Math.max(0,s-v+x),i=Math.max(0,i-j+m),n=Math.max(0,n-y+d);for(let e=0;e<l.length;e++)l[e]++;for(let e=0;e<d;e++)l.push(1);for(let e=0;e<y&&l.length>0;e++)l.shift();for(let e=0;e<o.length;e++)o[e]++;for(let e=0;e<m;e++)o.push(1);for(let e=0;e<j&&o.length>0;e++)o.shift();let N=0;for(let t of l){let a=Math.min(t/e.gmvRampMonths,1);N+=e.gmvPerFranchiseMonthly*a}let w=0;for(let t of o){let a=Math.min(t/e.gmvRampMonths,1);w+=e.gmvPerJVMonthly*a}let M=N+w,R=d*e.franchiseFee,F=r*e.tier1Price,P=s*e.tier2Price,C=i*e.jvPrice,S=n*e.franchiseMembershipPrice,T=F+P+C+S,k=R+T,V=M*e.royaltyRate,A=M*e.platformFeeRate,J=0;if(c>=e.materialStartMonth){let t=c-e.materialStartMonth+1;for(let a of l){let r=Math.min(Math.min(a,t)/Math.max(1,e.materialRampMonths),1)*e.materialAdoptionRate,s=Math.min(a/e.gmvRampMonths,1);J+=e.gmvPerFranchiseMonthly*s*r}for(let a of o){let r=Math.min(Math.min(a,t)/Math.max(1,e.materialRampMonths),1)*e.materialAdoptionRate,s=Math.min(a/e.gmvRampMonths,1);J+=e.gmvPerJVMonthly*s*r}}let O=J*e.materialPctOfGMV,E=O*e.materialMarkup,G=k+V+A+E,I=d*e.commissionPerFranchise+h*e.commissionPerTier1+x*e.commissionPerTier2+m*e.commissionPerJV,D=Z(e,n,i,r,s),$=I+D;return{month:a[c],monthIdx:c,newF:d,newT1:h,newT2:x,newJV:m,activeTier1:r,activeTier2:s,activeJV:i,activeFranchises:n,activeMembers:r+s,franchiseGMV:N,jvGMV:w,systemGMV:M,revFranchiseFees:R,revTier1:F,revTier2:P,revJV:C,revFranchiseDues:S,revMembership:T,revHeadOffice:k,revRoyalties:V,revPlatformFees:A,materialVolume:O,revMaterialMarkup:E,totalRevenue:G,costCommissions:I,costOverhead:D,totalCost:$,operatingProfit:G-$,cumProfit:0,cumRevenue:0}}),d=0,h=0;c.forEach(e=>{d+=e.operatingProfit,h+=e.totalRevenue,e.cumProfit=d,e.cumRevenue=h});let x=[];for(let e=0;e<Math.ceil(c.length/12);e++){let t=c.slice(12*e,(e+1)*12);if(0===t.length)continue;let a=t[t.length-1];x.push({year:2026+e,revenue:t.reduce((e,t)=>e+t.totalRevenue,0),cost:t.reduce((e,t)=>e+t.totalCost,0),profit:t.reduce((e,t)=>e+t.operatingProfit,0),franchiseFees:t.reduce((e,t)=>e+t.revFranchiseFees,0),membership:t.reduce((e,t)=>e+t.revMembership,0),royalties:t.reduce((e,t)=>e+t.revRoyalties,0),platformFees:t.reduce((e,t)=>e+t.revPlatformFees,0),materialMarkup:t.reduce((e,t)=>e+t.revMaterialMarkup,0),commissions:t.reduce((e,t)=>e+t.costCommissions,0),overhead:t.reduce((e,t)=>e+t.costOverhead,0),endMembers:a.activeTier1+a.activeTier2,endJV:a.activeJV,endFranchises:a.activeFranchises,gmv:t.reduce((e,t)=>e+t.systemGMV,0)})}let m=c.reduce((e,t)=>e+t.totalRevenue,0),p=c.reduce((e,t)=>e+t.operatingProfit,0),u=c[c.length-1],g=c.findIndex(e=>e.cumProfit>0);return{rows:c,years:x,totalRevenue:m,totalProfit:p,lastRow:u,breakEvenMonth:g}})(eF,e)),[eF,eP]),eG=eE[eC];(0,a.useMemo)(()=>eE.map((e,t)=>({name:eP[t].name,color:eP[t].color,totalRevenue:e.totalRevenue,totalProfit:e.totalProfit,endMembers:e.lastRow.activeTier1+e.lastRow.activeTier2,endJV:e.lastRow.activeJV,endFranchises:e.lastRow.activeFranchises,breakEvenMonth:e.breakEvenMonth})),[eE,eP]);let eI=K(eS.months.length);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-indigo-900 via-indigo-800 to-purple-800 text-white px-6 py-5",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"The Fence Company"}),(0,t.jsx)("p",{className:"text-indigo-200 text-sm mt-1",children:"Franchise Growth Scenario Planner"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{ref:em,type:"file",accept:".json",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let a=new FileReader;a.onload=e=>{try{let t=JSON.parse(e.target?.result);t.assumptions&&t.scenarios?(I(eA(t)),es("Loaded from file!"),setTimeout(()=>es(""),2e3)):es("Invalid file format")}catch{es("Invalid JSON file")}},a.readAsText(t),e.target.value=""},className:"hidden"}),(0,t.jsx)("button",{onClick:()=>em.current?.click(),className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-indigo-700/50 hover:bg-indigo-600 border border-indigo-500/50 transition",children:"Import JSON"}),(0,t.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify(G,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`franchise-scenarios-${new Date().toISOString().slice(0,10)}.json`,a.click(),URL.revokeObjectURL(t)},className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-indigo-700/50 hover:bg-indigo-600 border border-indigo-500/50 transition",children:"Export JSON"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-indigo-700/30 rounded-lg px-3 py-1.5 border border-indigo-500/30",children:[(0,t.jsx)("input",{value:el,onChange:e=>eo(e.target.value),placeholder:"Version name...",className:"bg-transparent text-xs text-white placeholder-indigo-300 outline-none w-28"}),(0,t.jsx)("button",{onClick:()=>{let e=el||"Version "+(ei.length+1),t={name:e,data:JSON.stringify(G),date:new Date().toLocaleString()};en(e=>[...e,t]),eo(""),es("Saved: "+e),setTimeout(()=>es(""),2e3)},className:"text-xs font-bold text-indigo-200 hover:text-white",children:"Save"})]}),er&&(0,t.jsx)("span",{className:"text-xs text-green-300 font-medium animate-pulse",children:er})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[eP.map((e,a)=>(0,t.jsxs)("div",{onClick:()=>I(e=>({...e,activeScenario:a})),onDoubleClick:()=>{ed(a),ex(e.name)},className:`px-4 py-2 rounded-t-lg text-xs font-medium transition cursor-pointer flex items-center gap-2 ${a===eC?"bg-white text-indigo-900 shadow-lg":"bg-indigo-700/30 text-indigo-200 hover:bg-indigo-700/50"}`,children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),ec===a?(0,t.jsx)("input",{autoFocus:!0,value:eh,onChange:e=>ex(e.target.value),onBlur:()=>{eh.trim()&&eV("name",eh.trim()),ed(null)},onKeyDown:e=>{"Enter"===e.key&&(eh.trim()&&eV("name",eh.trim()),ed(null)),"Escape"===e.key&&ed(null)},onClick:e=>e.stopPropagation(),className:"bg-transparent border-b border-indigo-300 outline-none text-xs w-32 px-0 py-0"}):(0,t.jsx)("span",{children:e.name})]},a)),(0,t.jsx)("button",{onClick:()=>{I(e=>{let t=e.scenarios[e.activeScenario];return{...e,scenarios:[...e.scenarios,{...JSON.parse(JSON.stringify(t)),name:"Scenario "+(e.scenarios.length+1),color:et[e.scenarios.length%et.length]}],activeScenario:e.scenarios.length}})},className:"px-3 py-2 rounded-t-lg text-xs text-indigo-300 hover:text-white hover:bg-indigo-700/30 transition",children:"+ New"}),(0,t.jsx)("button",{onClick:()=>{I(e=>{let t=e.scenarios[e.activeScenario];return{...e,scenarios:[...e.scenarios,{...JSON.parse(JSON.stringify(t)),name:t.name+" (Copy)"}],activeScenario:e.scenarios.length}})},className:"px-3 py-2 rounded-t-lg text-xs text-indigo-300 hover:text-white hover:bg-indigo-700/30 transition",children:"Duplicate"}),eP.length>1&&(0,t.jsx)("button",{onClick:()=>{G.scenarios.length<=1||I(e=>{let t=e.scenarios.filter((t,a)=>a!==e.activeScenario);return{...e,scenarios:t,activeScenario:Math.min(e.activeScenario,t.length-1)}})},className:"px-3 py-2 rounded-t-lg text-xs text-red-300 hover:text-red-200 hover:bg-red-900/30 transition",children:"Delete"}),(0,t.jsx)("span",{className:"text-indigo-400/50 text-xs ml-2",children:"double-click to rename"})]})]})}),(0,t.jsx)("div",{className:"bg-white border-b shadow-sm sticky top-0 z-10",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto flex",children:[{id:"overview",label:"Overview"},{id:"monthly",label:"Monthly Detail"},{id:"sales",label:"Sales Pipeline"},{id:"assumptions",label:"Assumptions"},{id:"compare",label:"Compare"}].map(e=>(0,t.jsx)("button",{onClick:()=>L(e.id),className:`px-5 py-3 text-sm font-medium border-b-2 transition-colors ${D===e.id?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.label},e.id))})}),ei.length>0&&(0,t.jsx)("div",{className:"bg-amber-50 border-b border-amber-200 px-6 py-2",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center gap-3 overflow-x-auto",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-amber-700 whitespace-nowrap",children:"Saved:"}),ei.map((e,a)=>(0,t.jsxs)("button",{onClick:()=>{I(eA(JSON.parse(e.data))),es("Loaded: "+e.name),setTimeout(()=>es(""),2e3)},className:"flex items-center gap-2 px-3 py-1 rounded-full text-xs bg-white border border-amber-300 hover:bg-amber-100 transition whitespace-nowrap",children:[(0,t.jsx)("span",{className:"font-medium text-amber-800",children:e.name}),(0,t.jsx)("span",{className:"text-amber-500",children:e.date})]},a))]})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:["overview"===D&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[(0,t.jsx)(q,{label:"Total Revenue",value:Y(eG.totalRevenue),subtext:eG.rows.length+" mo",positive:!0}),(0,t.jsx)(q,{label:"Total Profit",value:Y(eG.totalProfit),positive:eG.totalProfit>0,negative:eG.totalProfit<0}),(0,t.jsx)(q,{label:"Members (T1+T2)",value:(eG.lastRow.activeTier1+eG.lastRow.activeTier2).toString(),subtext:"T1:"+eG.lastRow.activeTier1+" T2:"+eG.lastRow.activeTier2}),(0,t.jsx)(q,{label:"JV Partners",value:eG.lastRow.activeJV.toString(),subtext:U(eG.lastRow.jvGMV)+"/mo"}),(0,t.jsx)(q,{label:"Franchises",value:eG.lastRow.activeFranchises.toString(),subtext:U(eG.lastRow.franchiseGMV)+"/mo"}),(0,t.jsx)(q,{label:"Break-Even",value:eG.breakEvenMonth>=0?"Mo "+(eG.breakEvenMonth+1):"Never",subtext:eG.breakEvenMonth>=0?eI[eG.breakEvenMonth]:"",positive:eG.breakEvenMonth>=0}),(0,t.jsx)(q,{label:"Recurring/Mo",value:U(eG.lastRow.revMembership+eG.lastRow.revMaterialMarkup+eG.lastRow.revRoyalties),subtext:"Mbr+Matl+Roy",positive:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,t.jsxs)("div",{className:"col-span-8 bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Monthly Revenue & Operating Profit"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:320,children:(0,t.jsxs)(u.ComposedChart,{data:eG.rows,children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:2,angle:-45,textAnchor:"end",height:50}),(0,t.jsx)(i.YAxis,{tickFormatter:U,tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)}),(0,t.jsx)(o.Legend,{wrapperStyle:{fontSize:11}}),(0,t.jsx)(r.Bar,{dataKey:"revFranchiseFees",name:"Franchise Fees",fill:"#8b5cf6",stackId:"rev",opacity:.8}),(0,t.jsx)(r.Bar,{dataKey:"revMembership",name:"Membership",fill:"#3b82f6",stackId:"rev",opacity:.8}),(0,t.jsx)(r.Bar,{dataKey:"revRoyalties",name:"Royalties",fill:"#10b981",stackId:"rev",opacity:.8}),(0,t.jsx)(r.Bar,{dataKey:"revMaterialMarkup",name:"Material Markup",fill:"#f97316",stackId:"rev",opacity:.8}),(0,t.jsx)(g.Line,{dataKey:"operatingProfit",name:"Op. Profit",stroke:"#f59e0b",strokeWidth:3,dot:!1}),(0,t.jsx)($,{y:0,stroke:"#999",strokeDasharray:"3 3"})]})})]}),(0,t.jsxs)("div",{className:"col-span-4 space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Annual Summary"}),(0,t.jsx)("div",{className:"space-y-3",children:eG.years.map(e=>(0,t.jsxs)("div",{className:`rounded-lg p-3 border ${e.profit>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-bold text-gray-800",children:e.year}),(0,t.jsx)("span",{className:`text-sm font-bold ${e.profit>=0?"text-green-600":"text-red-600"}`,children:B(e.profit)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 mt-2 text-xs text-gray-500",children:[(0,t.jsxs)("div",{children:["Revenue: ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:U(e.revenue)})]}),(0,t.jsxs)("div",{children:["Cost: ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:U(e.cost)})]}),(0,t.jsxs)("div",{children:["Members: ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:e.endMembers})]}),(0,t.jsxs)("div",{children:["JV: ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:e.endJV})," Â· Fran: ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:e.endFranchises})]})]})]},e.year))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Revenue Mix (Total)"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:180,children:(0,t.jsxs)(d.PieChart,{children:[(0,t.jsx)(h.Pie,{data:[{name:"Franchise Fees",value:eG.rows.reduce((e,t)=>e+t.revFranchiseFees,0)},{name:"Software Licenses",value:eG.rows.reduce((e,t)=>e+t.revFranchiseDues,0)},{name:"Tier 1",value:eG.rows.reduce((e,t)=>e+t.revTier1,0)},{name:"Tier 2",value:eG.rows.reduce((e,t)=>e+t.revTier2,0)},{name:"JV Dues",value:eG.rows.reduce((e,t)=>e+t.revJV,0)},{name:"Royalties",value:eG.rows.reduce((e,t)=>e+t.revRoyalties,0)},{name:"Material Markup",value:eG.rows.reduce((e,t)=>e+t.revMaterialMarkup,0)},{name:"Platform Fees",value:eG.rows.reduce((e,t)=>e+t.revPlatformFees,0)}].filter(e=>e.value>0),dataKey:"value",cx:"50%",cy:"50%",outerRadius:70,label:e=>U(e.value),style:{fontSize:9},children:ea.map((e,a)=>(0,t.jsx)(x.Cell,{fill:e},a))}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)})]})})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Cumulative Revenue & Profit"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:220,children:(0,t.jsxs)(u.ComposedChart,{data:eG.rows,children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:2,angle:-45,textAnchor:"end",height:50}),(0,t.jsx)(i.YAxis,{tickFormatter:U,tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)}),(0,t.jsx)(o.Legend,{wrapperStyle:{fontSize:11}}),(0,t.jsxs)("defs",{children:[(0,t.jsxs)("linearGradient",{id:"cumRevGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.2}),(0,t.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),(0,t.jsxs)("linearGradient",{id:"cumProfitGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.2}),(0,t.jsx)("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),(0,t.jsx)(m.Area,{dataKey:"cumRevenue",name:"Cumulative Revenue",stroke:"#3b82f6",fill:"url(#cumRevGrad)",strokeWidth:2}),(0,t.jsx)(m.Area,{dataKey:"cumProfit",name:"Cumulative Profit",stroke:"#10b981",fill:"url(#cumProfitGrad)",strokeWidth:2.5}),(0,t.jsx)($,{y:0,stroke:"#999",strokeDasharray:"3 3"})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Membership & Franchise Growth"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:250,children:(0,t.jsxs)(p.AreaChart,{data:eG.rows,children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:2,angle:-45,textAnchor:"end",height:50}),(0,t.jsx)(i.YAxis,{tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{}),(0,t.jsx)(o.Legend,{wrapperStyle:{fontSize:11}}),(0,t.jsx)(m.Area,{dataKey:"activeTier1",name:"Tier 1",fill:"#3b82f6",stroke:"#3b82f6",fillOpacity:.3,stackId:"m"}),(0,t.jsx)(m.Area,{dataKey:"activeTier2",name:"Tier 2",fill:"#10b981",stroke:"#10b981",fillOpacity:.3,stackId:"m"}),(0,t.jsx)(m.Area,{dataKey:"activeJV",name:"JV",fill:"#f59e0b",stroke:"#f59e0b",fillOpacity:.3,stackId:"m"}),(0,t.jsx)(g.Line,{dataKey:"activeFranchises",name:"Franchises",stroke:"#ef4444",strokeWidth:3,dot:!1})]})})]})]}),"monthly"===D&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-x-auto",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Monthly P&L Detail"}),(0,t.jsxs)("table",{className:"w-full text-xs",style:{minWidth:1200},children:[(0,t.jsxs)("thead",{children:[(0,t.jsxs)("tr",{className:"border-b-2 border-gray-300 whitespace-nowrap",children:[(0,t.jsx)("th",{className:"text-left py-2 px-2 sticky left-0 bg-white font-bold",children:"Month"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"New F"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"New T1"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"New T2"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"New JV"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 bg-blue-50",children:"Mbrs"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 bg-blue-50",children:"JV"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 bg-blue-50",children:"Fran"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Fran $"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Soft Lic"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Mbr $"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Royalty"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 text-orange-700",children:"Matl $"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Platform"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 font-bold bg-green-50",children:"Revenue"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Comm"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Overhead"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 font-bold bg-red-50",children:"Cost"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold",children:"Profit"}),(0,t.jsx)("th",{className:"text-right py-2 px-2",children:"Cumul"})]}),(e=eG.rows.reduce((e,t)=>({newF:e.newF+t.newF,newT1:e.newT1+t.newT1,newT2:e.newT2+t.newT2,newJV:e.newJV+t.newJV,revFranchiseFees:e.revFranchiseFees+t.revFranchiseFees,revFranchiseDues:e.revFranchiseDues+t.revFranchiseDues,revMembership:e.revMembership+t.revMembership,revRoyalties:e.revRoyalties+t.revRoyalties,revMaterialMarkup:e.revMaterialMarkup+t.revMaterialMarkup,revPlatformFees:e.revPlatformFees+t.revPlatformFees,totalRevenue:e.totalRevenue+t.totalRevenue,costCommissions:e.costCommissions+t.costCommissions,costOverhead:e.costOverhead+t.costOverhead,totalCost:e.totalCost+t.totalCost,operatingProfit:e.operatingProfit+t.operatingProfit}),{newF:0,newT1:0,newT2:0,newJV:0,revFranchiseFees:0,revFranchiseDues:0,revMembership:0,revRoyalties:0,revMaterialMarkup:0,revPlatformFees:0,totalRevenue:0,costCommissions:0,costOverhead:0,totalCost:0,operatingProfit:0}),f=eG.lastRow,(0,t.jsxs)("tr",{className:"border-b-2 border-indigo-300 bg-indigo-50 font-bold text-xs",children:[(0,t.jsx)("td",{className:"py-2 px-2 sticky left-0 bg-indigo-50 font-bold text-indigo-800",children:"TOTALS"}),(0,t.jsx)("td",{className:"text-right py-2 px-1 text-purple-700",children:e.newF}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:e.newT1}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:e.newT2}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:e.newJV}),(0,t.jsx)("td",{className:"text-right py-2 px-1 bg-indigo-100",children:f.activeTier1+f.activeTier2}),(0,t.jsx)("td",{className:"text-right py-2 px-1 bg-indigo-100",children:f.activeJV}),(0,t.jsx)("td",{className:"text-right py-2 px-1 bg-indigo-100",children:f.activeFranchises}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.revFranchiseFees)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.revFranchiseDues)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.revMembership)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.revRoyalties)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 text-orange-700",children:U(e.revMaterialMarkup)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:B(e.revPlatformFees)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 bg-green-100",children:U(e.totalRevenue)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.costCommissions)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(e.costOverhead)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 bg-red-100",children:U(e.totalCost)}),(0,t.jsx)("td",{className:`text-right py-2 px-2 ${e.operatingProfit>=0?"text-green-700":"text-red-700"}`,children:U(e.operatingProfit)}),(0,t.jsx)("td",{className:"text-right py-2 px-2"})]}))]}),(0,t.jsx)("tbody",{children:eG.rows.map((e,a)=>{let r=a>0&&a%12==0;return(0,t.jsxs)("tr",{className:`border-b ${e.operatingProfit>=0?"":"bg-red-50/30"} ${r?"border-t-2 border-gray-400":""} hover:bg-blue-50/30`,children:[(0,t.jsx)("td",{className:"py-1.5 px-2 font-medium sticky left-0 bg-white",children:e.month}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 text-purple-600",children:e.newF||""}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.newT1||""}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.newT2||""}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.newJV||""}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 bg-blue-50/50 font-medium",children:e.activeTier1+e.activeTier2}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 bg-blue-50/50 font-medium",children:e.activeJV}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 bg-blue-50/50 font-medium",children:e.activeFranchises}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.revFranchiseFees?U(e.revFranchiseFees):"-"}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.revFranchiseDues?U(e.revFranchiseDues):"-"}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:U(e.revMembership)}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.revRoyalties?U(e.revRoyalties):"-"}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 text-orange-600",children:e.revMaterialMarkup?U(e.revMaterialMarkup):"-"}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 text-gray-400",children:B(e.revPlatformFees)}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 font-bold bg-green-50/50",children:U(e.totalRevenue)}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:e.costCommissions?U(e.costCommissions):"-"}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1",children:U(e.costOverhead)}),(0,t.jsx)("td",{className:"text-right py-1.5 px-1 font-bold bg-red-50/50",children:U(e.totalCost)}),(0,t.jsx)("td",{className:`text-right py-1.5 px-2 font-bold ${e.operatingProfit>=0?"text-green-700":"text-red-700"}`,children:U(e.operatingProfit)}),(0,t.jsx)("td",{className:`text-right py-1.5 px-2 ${e.cumProfit>=0?"text-green-600":"text-red-600"}`,children:U(e.cumProfit)})]},a)})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"System GMV (with Franchise Ramp)"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:200,children:(0,t.jsxs)(p.AreaChart,{data:eG.rows,children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:2,angle:-45,textAnchor:"end",height:50}),(0,t.jsx)(i.YAxis,{tickFormatter:U,tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)}),(0,t.jsx)("defs",{children:(0,t.jsxs)("linearGradient",{id:"gmvGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.3}),(0,t.jsx)("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),(0,t.jsx)(m.Area,{dataKey:"systemGMV",name:"System GMV",stroke:"#8b5cf6",fill:"url(#gmvGrad)",strokeWidth:2})]})})]})]}),"sales"===D&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(ee,{title:"Scenario: "+eS.name,color:"indigo",children:(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[(0,t.jsx)(_,{label:"Starting Tier 1",value:eS.startingTier1,onChange:e=>eV("startingTier1",Math.max(0,e))}),(0,t.jsx)(_,{label:"Starting Tier 2",value:eS.startingTier2,onChange:e=>eV("startingTier2",Math.max(0,e))}),(0,t.jsx)(_,{label:"Starting JV",value:eS.startingJV,onChange:e=>eV("startingJV",Math.max(0,e))}),(0,t.jsx)(_,{label:"Starting Franchises",value:eS.startingFranchises,onChange:e=>eV("startingFranchises",Math.max(0,e))})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-x-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start gap-3 mb-3",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 truncate",children:"Monthly New Sales (edit each cell)"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Edit ",(0,t.jsx)("span",{className:"font-bold text-indigo-600",children:"âš¡ TOTALS"})," row to auto-distribute with seasonality, or edit months directly."]}),(0,t.jsx)("p",{className:"text-xs text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis",children:"Franchises/JV â†’ Jul-Oct Â· Memberships â†’ Apr-Sep heavier Â· Tab moves down column"})]}),(0,t.jsx)("div",{className:"flex gap-2 flex-shrink-0",children:(0,t.jsx)("button",{onClick:()=>{let e=[...eS.months];if(e.length<120){for(let t=0;t<12;t++)e.push({franchises:0,tier1:0,tier2:0,jv:0});eV("months",e)}},className:"text-xs bg-indigo-600 text-white px-3 py-1.5 rounded-lg hover:bg-indigo-700 whitespace-nowrap",children:"+ Add Year"})})]}),(0,t.jsxs)("table",{className:"w-full text-xs",style:{minWidth:700},children:[(0,t.jsxs)("thead",{children:[(0,t.jsxs)("tr",{className:"border-b-2 border-gray-300",children:[(0,t.jsx)("th",{className:"text-left py-2 px-2 font-bold whitespace-nowrap",style:{width:80},children:"Month"}),(0,t.jsx)("th",{className:"text-center py-2 px-1 font-bold text-purple-700 whitespace-nowrap",style:{width:72},children:"Fran"}),(0,t.jsx)("th",{className:"text-center py-2 px-1 font-bold text-blue-700 whitespace-nowrap",style:{width:72},children:"Tier 1"}),(0,t.jsx)("th",{className:"text-center py-2 px-1 font-bold text-green-700 whitespace-nowrap",style:{width:72},children:"Tier 2"}),(0,t.jsx)("th",{className:"text-center py-2 px-1 font-bold text-amber-700 whitespace-nowrap",style:{width:72},children:"JV"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold bg-gray-50 whitespace-nowrap",style:{width:64},children:"Mbrs"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold bg-gray-50 whitespace-nowrap",style:{width:64},children:"Act JV"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold bg-gray-50 whitespace-nowrap",style:{width:64},children:"Act Fran"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold bg-green-50 whitespace-nowrap",style:{width:80},children:"Revenue"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold whitespace-nowrap",style:{width:80},children:"Profit"})]}),(b=eG.rows.reduce((e,t)=>({totalRevenue:e.totalRevenue+t.totalRevenue,operatingProfit:e.operatingProfit+t.operatingProfit}),{totalRevenue:0,operatingProfit:0}),v=eS.months.reduce((e,t)=>e+t.franchises,0),j=eS.months.reduce((e,t)=>e+t.tier1,0),y=eS.months.reduce((e,t)=>e+t.tier2,0),N=eS.months.reduce((e,t)=>e+t.jv,0),w=eG.lastRow,M="w-full text-center text-xs font-bold border border-indigo-300 rounded p-1 bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none",(0,t.jsxs)("tr",{className:"border-b-2 border-indigo-300 bg-indigo-50 font-bold text-xs",children:[(0,t.jsx)("td",{className:"py-2 px-2 font-bold text-indigo-800",title:"Edit totals to auto-distribute with seasonality",children:"âš¡ TOTALS"}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:v,onChange:e=>eJ("franchises",parseInt(e.target.value)||0),className:M,title:"Distributes to Jul-Oct selling season"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:j,onChange:e=>eJ("tier1",parseInt(e.target.value)||0),className:M,title:"Heavier Apr-Sep, lighter rest of year"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:y,onChange:e=>eJ("tier2",parseInt(e.target.value)||0),className:M,title:"Heavier Apr-Sep, lighter rest of year"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:N,onChange:e=>eJ("jv",parseInt(e.target.value)||0),className:M,title:"Distributes to Jul-Oct selling season"})}),(0,t.jsx)("td",{className:"text-right py-2 px-2 bg-indigo-100",children:w.activeTier1+w.activeTier2}),(0,t.jsx)("td",{className:"text-right py-2 px-2 bg-indigo-100",children:w.activeJV}),(0,t.jsx)("td",{className:"text-right py-2 px-2 bg-indigo-100",children:w.activeFranchises}),(0,t.jsx)("td",{className:"text-right py-2 px-2 bg-green-100",children:U(b.totalRevenue)}),(0,t.jsx)("td",{className:`text-right py-2 px-2 ${b.operatingProfit>=0?"text-green-700":"text-red-700"}`,children:U(b.operatingProfit)})]}))]}),(0,t.jsx)("tbody",{children:eS.months.map((e,a)=>{let r=eG.rows[a],s=a>0&&a%12==0;return(0,t.jsxs)("tr",{className:`border-b hover:bg-indigo-50/30 ${s?"border-t-2 border-gray-400":""}`,children:[(0,t.jsx)("td",{className:"py-1 px-2 font-medium text-gray-600",children:eI[a]}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:e.franchises,onChange:e=>ek(a,"franchises",parseInt(e.target.value)||0),"data-row":a,"data-col":"franchises",onKeyDown:eO,className:"w-full text-center text-xs border border-gray-200 rounded p-1 focus:ring-1 focus:ring-purple-400 focus:border-purple-400 outline-none"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:e.tier1,onChange:e=>ek(a,"tier1",parseInt(e.target.value)||0),"data-row":a,"data-col":"tier1",onKeyDown:eO,className:"w-full text-center text-xs border border-gray-200 rounded p-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:e.tier2,onChange:e=>ek(a,"tier2",parseInt(e.target.value)||0),"data-row":a,"data-col":"tier2",onKeyDown:eO,className:"w-full text-center text-xs border border-gray-200 rounded p-1 focus:ring-1 focus:ring-green-400 focus:border-green-400 outline-none"})}),(0,t.jsx)("td",{className:"py-1 px-1",children:(0,t.jsx)("input",{type:"number",min:0,value:e.jv,onChange:e=>ek(a,"jv",parseInt(e.target.value)||0),"data-row":a,"data-col":"jv",onKeyDown:eO,className:"w-full text-center text-xs border border-gray-200 rounded p-1 focus:ring-1 focus:ring-amber-400 focus:border-amber-400 outline-none"})}),(0,t.jsx)("td",{className:"text-right py-1 px-2 bg-gray-50/50 font-medium",children:r?r.activeTier1+r.activeTier2:""}),(0,t.jsx)("td",{className:"text-right py-1 px-2 bg-gray-50/50 font-medium",children:r?.activeJV}),(0,t.jsx)("td",{className:"text-right py-1 px-2 bg-gray-50/50 font-medium",children:r?.activeFranchises}),(0,t.jsx)("td",{className:"text-right py-1 px-2 bg-green-50/50 font-medium",children:r?U(r.totalRevenue):"-"}),(0,t.jsx)("td",{className:`text-right py-1 px-2 font-bold ${r&&r.operatingProfit>=0?"text-green-700":"text-red-700"}`,children:r?U(r.operatingProfit):"-"})]},a)})})]})]})]}),"assumptions"===D&&(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,t.jsxs)("div",{className:"col-span-4 space-y-4",children:[(0,t.jsxs)(ee,{title:"Pricing",color:"blue",children:[(0,t.jsx)(_,{label:"Franchise Fee",value:eF.franchiseFee,onChange:e=>eT("franchiseFee",e),prefix:"$",step:1e3}),(0,t.jsx)(_,{label:"Tier 1 Monthly",value:eF.tier1Price,onChange:e=>eT("tier1Price",e),prefix:"$",step:100}),(0,t.jsx)(_,{label:"Tier 2 Monthly",value:eF.tier2Price,onChange:e=>eT("tier2Price",e),prefix:"$",step:100}),(0,t.jsx)(_,{label:"JV Monthly",value:eF.jvPrice,onChange:e=>eT("jvPrice",e),prefix:"$",step:100}),(0,t.jsx)(_,{label:"Software License Monthly",value:eF.franchiseMembershipPrice,onChange:e=>eT("franchiseMembershipPrice",e),prefix:"$",step:100})]}),(0,t.jsxs)(ee,{title:"Commissions",color:"amber",children:[(0,t.jsx)(_,{label:"Per Franchise Sale",value:eF.commissionPerFranchise,onChange:e=>eT("commissionPerFranchise",e),prefix:"$",step:500}),(0,t.jsx)(_,{label:"Per Tier 1 Sale",value:eF.commissionPerTier1,onChange:e=>eT("commissionPerTier1",e),prefix:"$",step:50}),(0,t.jsx)(_,{label:"Per Tier 2 Sale",value:eF.commissionPerTier2,onChange:e=>eT("commissionPerTier2",e),prefix:"$",step:50}),(0,t.jsx)(_,{label:"Per JV Sale",value:eF.commissionPerJV,onChange:e=>eT("commissionPerJV",e),prefix:"$",step:50})]})]}),(0,t.jsxs)("div",{className:"col-span-4 space-y-4",children:[(0,t.jsxs)(ee,{title:"Operations",color:"green",children:[(0,t.jsx)(_,{label:"Base Overhead (floor)",value:eF.overheadMonthly,onChange:e=>eT("overheadMonthly",e),prefix:"$",step:1e3}),(0,t.jsx)(_,{label:"Salary Unit Cost",value:eF.overheadSalaryUnit,onChange:e=>eT("overheadSalaryUnit",e),prefix:"$",step:1e3}),(0,t.jsx)(_,{label:"Fran/JV per Unit",value:eF.overheadCapFranchiseJV,onChange:e=>eT("overheadCapFranchiseJV",e),step:1,min:1}),(0,t.jsx)(_,{label:"Tier 1 per Unit",value:eF.overheadCapTier1,onChange:e=>eT("overheadCapTier1",e),step:1,min:1}),(0,t.jsx)(_,{label:"Tier 2 per Unit",value:eF.overheadCapTier2,onChange:e=>eT("overheadCapTier2",e),step:1,min:1}),(0,t.jsx)(_,{label:"Scale Exponent",value:eF.overheadScaleExponent,onChange:e=>eT("overheadScaleExponent",e),step:.05,min:.3,max:1.5}),(0,t.jsx)(_,{label:"Royalty Rate",value:100*eF.royaltyRate,onChange:e=>eT("royaltyRate",e/100),suffix:"%",step:.5}),(0,t.jsx)(_,{label:"Platform Fee Rate",value:100*eF.platformFeeRate,onChange:e=>eT("platformFeeRate",e/100),suffix:"%",step:.01}),(0,t.jsxs)("div",{className:"mt-3 p-3 bg-green-100 rounded-lg text-xs text-green-800",children:[(0,t.jsx)("p",{className:"font-bold mb-1",children:"ðŸ“Š How Overhead Scales"}),(0,t.jsxs)("p",{children:["Base overhead of ",(0,t.jsxs)("span",{className:"font-bold",children:[B(eF.overheadMonthly),"/mo"]})," covers rent, tools, insurance â€” fixed regardless of size."]}),(0,t.jsxs)("p",{className:"mt-1",children:["Each ",(0,t.jsx)("span",{className:"font-bold",children:B(eF.overheadSalaryUnit)})," salary unit supports ",(0,t.jsx)("span",{className:"font-bold",children:eF.overheadCapFranchiseJV})," franchises/JVs, ",(0,t.jsx)("span",{className:"font-bold",children:eF.overheadCapTier1})," T1, or ",(0,t.jsx)("span",{className:"font-bold",children:eF.overheadCapTier2})," T2 members."]}),(0,t.jsxs)("p",{className:"mt-1",children:["Scale exponent of ",(0,t.jsx)("span",{className:"font-bold",children:eF.overheadScaleExponent})," means ",eF.overheadScaleExponent<1?"economies of scale â€” doubling clients costs only "+((Math.pow(2,eF.overheadScaleExponent)-1)*100).toFixed(0)+"% more staff (not 100%)":1===eF.overheadScaleExponent?"linear scaling â€” no economies":"diseconomies â€” scaling gets harder","."]}),(0,t.jsxs)("div",{className:"mt-2 border-t border-green-300 pt-2",children:[(0,t.jsx)("p",{className:"font-bold mb-1",children:"Example overhead at different scales:"}),[{f:5,j:1,t1:10,t2:5},{f:20,j:3,t1:30,t2:15},{f:50,j:5,t1:60,t2:30}].map(e=>(0,t.jsxs)("p",{className:"text-green-700",children:[e.f,"F + ",e.j,"JV + ",e.t1,"T1 + ",e.t2,"T2 â†’ ",(0,t.jsxs)("span",{className:"font-bold",children:[B(Z(eF,e.f,e.j,e.t1,e.t2)),"/mo"]})]},e.f))]}),(0,t.jsxs)("p",{className:"mt-2 text-green-600 italic",children:["Current end-state: ",B(Z(eF,eG.lastRow.activeFranchises,eG.lastRow.activeJV,eG.lastRow.activeTier1,eG.lastRow.activeTier2)),"/mo"]})]})]}),(0,t.jsxs)(ee,{title:"Franchise Economics",color:"purple",children:[(0,t.jsx)(_,{label:"GMV per Franchise/Month",value:eF.gmvPerFranchiseMonthly,onChange:e=>eT("gmvPerFranchiseMonthly",e),prefix:"$",step:5e3}),(0,t.jsx)(_,{label:"GMV per JV/Month",value:eF.gmvPerJVMonthly,onChange:e=>eT("gmvPerJVMonthly",e),prefix:"$",step:5e3}),(0,t.jsx)(_,{label:"GMV Ramp Months",value:eF.gmvRampMonths,onChange:e=>eT("gmvRampMonths",e),step:1,min:1,max:12}),(0,t.jsxs)("div",{className:"mt-3 p-3 bg-purple-100 rounded-lg text-xs text-purple-800",children:[(0,t.jsx)("p",{className:"font-bold mb-1",children:"Franchise & JV GMV Model"}),(0,t.jsxs)("p",{children:["Franchises ramp to ",B(eF.gmvPerFranchiseMonthly),"/mo, JVs ramp to ",B(eF.gmvPerJVMonthly),"/mo over ",eF.gmvRampMonths," months."]}),(0,t.jsxs)("p",{className:"mt-1",children:["HQ earns ",H(eF.royaltyRate)," royalties + ",H(eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup)," material markup (",Q(100*eF.materialAdoptionRate)," adoption) + ",H(eF.platformFeeRate)," platform fees on GMV."]})]})]}),(0,t.jsxs)(ee,{title:"Material Sales",color:"amber",children:[(0,t.jsx)(_,{label:"Materials % of GMV",value:100*eF.materialPctOfGMV,onChange:e=>eT("materialPctOfGMV",e/100),suffix:"%",step:1,min:0,max:100}),(0,t.jsx)(_,{label:"HQ Markup on Materials",value:100*eF.materialMarkup,onChange:e=>eT("materialMarkup",e/100),suffix:"%",step:.5,min:0,max:50}),(0,t.jsx)(_,{label:"Max Adoption Rate",value:100*eF.materialAdoptionRate,onChange:e=>eT("materialAdoptionRate",e/100),suffix:"%",step:5,min:0,max:100}),(0,t.jsx)(_,{label:"Adoption Ramp (months)",value:eF.materialRampMonths,onChange:e=>eT("materialRampMonths",Math.max(1,e)),step:1,min:1,max:24}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Distribution Starts"}),(0,t.jsx)("select",{value:eF.materialStartMonth,onChange:e=>eT("materialStartMonth",parseInt(e.target.value)),className:"w-full text-xs border border-gray-300 rounded-lg px-2 py-1.5 mt-0.5 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none",children:K(60).map((e,a)=>(0,t.jsx)("option",{value:a,children:e},a))})]}),(0,t.jsxs)("div",{className:"mt-3 p-3 bg-amber-100 rounded-lg text-xs text-amber-800",children:[(0,t.jsx)("p",{className:"font-bold mb-1",children:"Material Adoption Model"}),(0,t.jsxs)("p",{children:["Program launches ",(0,t.jsx)("span",{className:"font-bold",children:K(60)[eF.materialStartMonth]}),". No material revenue before that."]}),(0,t.jsxs)("p",{className:"mt-1",children:["Each location ramps from 0% â†’ ",(0,t.jsx)("span",{className:"font-bold",children:Q(100*eF.materialAdoptionRate)})," adoption over ",(0,t.jsxs)("span",{className:"font-bold",children:[eF.materialRampMonths," months"]}),"."]}),(0,t.jsxs)("p",{className:"mt-1",children:["At full adoption: ",Q(100*eF.materialAdoptionRate)," of ",Q(100*eF.materialPctOfGMV)," GMV = ",(0,t.jsx)("span",{className:"font-bold",children:Q(eF.materialAdoptionRate*eF.materialPctOfGMV*100)})," of GMV flows through HQ."]}),(0,t.jsxs)("p",{className:"mt-1",children:["HQ earns ",Q(100*eF.materialMarkup)," markup = ",(0,t.jsxs)("span",{className:"font-bold",children:[B(eF.gmvPerFranchiseMonthly*eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup),"/franchise/month"]})," at steady state."]}),(0,t.jsxs)("p",{className:"mt-1",children:["Per franchise annual: ",(0,t.jsx)("span",{className:"font-bold",children:B(eF.gmvPerFranchiseMonthly*eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup*12)})]}),(0,t.jsxs)("div",{className:"mt-2 border-t border-amber-300 pt-2",children:[(0,t.jsx)("p",{className:"font-bold",children:"Ramp example (per location):"}),[1,2,3,4].filter(e=>e<=eF.materialRampMonths).map(e=>{let a=Math.min(e/eF.materialRampMonths,1)*eF.materialAdoptionRate;return(0,t.jsxs)("p",{className:"ml-2",children:["Mo ",e,": ",Q(100*a)," adoption â†’ ",B(eF.gmvPerFranchiseMonthly*eF.materialPctOfGMV*a*eF.materialMarkup),"/mo"]},e)}),(0,t.jsxs)("p",{className:"ml-2",children:["Mo ",eF.materialRampMonths,"+: ",Q(100*eF.materialAdoptionRate)," (full) â†’ ",B(eF.gmvPerFranchiseMonthly*eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup),"/mo"]})]})]})]})]}),(0,t.jsxs)("div",{className:"col-span-4 space-y-4",children:[(0,t.jsxs)(ee,{title:"Churn Rates (Annual)",color:"red",children:[(0,t.jsx)(_,{label:"Tier 1 Annual Churn",value:100*eF.churnRateTier1,onChange:e=>eT("churnRateTier1",e/100),suffix:"%",step:1}),(0,t.jsx)(_,{label:"Tier 2 Annual Churn",value:100*eF.churnRateTier2,onChange:e=>eT("churnRateTier2",e/100),suffix:"%",step:1}),(0,t.jsx)(_,{label:"JV Annual Churn",value:100*eF.churnRateJV,onChange:e=>eT("churnRateJV",e/100),suffix:"%",step:1}),(0,t.jsx)(_,{label:"Franchise Annual Churn",value:100*eF.churnRateFranchise,onChange:e=>eT("churnRateFranchise",e/100),suffix:"%",step:1}),(0,t.jsxs)("div",{className:"mt-3 p-3 bg-red-100 rounded-lg text-xs text-red-800",children:[(0,t.jsx)("p",{className:"font-bold mb-1",children:"Churn Conversion"}),(0,t.jsxs)("p",{children:["Rates entered as ",(0,t.jsx)("span",{className:"font-bold",children:"annual"}),", converted to monthly via compounding:"]}),(0,t.jsx)("p",{className:"mt-1 font-mono text-[10px] bg-red-50 rounded p-1",children:"monthly = 1 âˆ’ (1 âˆ’ annual)^(1/12)"}),(0,t.jsxs)("p",{className:"mt-1",children:["T1: ",(100*eF.churnRateTier1).toFixed(0),"%/yr â†’ ",(100*X(eF.churnRateTier1)).toFixed(2),"%/mo â†’ ",((1-eF.churnRateTier1)*100).toFixed(0),"% retention"]}),(0,t.jsxs)("p",{children:["Franchise: ",(100*eF.churnRateFranchise).toFixed(0),"%/yr â†’ ",(100*X(eF.churnRateFranchise)).toFixed(2),"%/mo â†’ ",((1-eF.churnRateFranchise)*100).toFixed(0),"% retention"]})]})]}),(0,t.jsx)(ee,{title:"Quick Sensitivity",color:"indigo",children:(0,t.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,t.jsxs)("p",{className:"text-gray-600",children:["Each additional Tier 1 member = ",(0,t.jsxs)("span",{className:"font-bold text-indigo-700",children:[B(12*eF.tier1Price),"/year"]})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Each additional Tier 2 member = ",(0,t.jsxs)("span",{className:"font-bold text-indigo-700",children:[B(12*eF.tier2Price),"/year"]})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Each additional JV = ",(0,t.jsxs)("span",{className:"font-bold text-indigo-700",children:[B(12*eF.jvPrice),"/yr dues + ",B(12*eF.gmvPerJVMonthly*(eF.royaltyRate+eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup+eF.platformFeeRate)),"/yr from GMV"]})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Each franchise sale = ",(0,t.jsxs)("span",{className:"font-bold text-indigo-700",children:[B(eF.franchiseFee)," upfront + ",B(12*eF.gmvPerFranchiseMonthly*eF.royaltyRate),"/yr royalties + ",B(eF.gmvPerFranchiseMonthly*eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup*12),"/yr materials"]})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Net per franchise sale (after comm.) = ",(0,t.jsx)("span",{className:"font-bold text-indigo-700",children:B(eF.franchiseFee-eF.commissionPerFranchise)})]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Annual recurring per franchise = ",(0,t.jsx)("span",{className:"font-bold text-indigo-700",children:B(12*eF.franchiseMembershipPrice+12*eF.gmvPerFranchiseMonthly*(eF.royaltyRate+eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup+eF.platformFeeRate))})," (software licenses + GMV income)"]})]})}),(0,t.jsx)(ee,{title:"ðŸ’° Sales Commission Calculator",color:"green",children:(R=ep*eF.commissionPerFranchise,F=eg*eF.commissionPerTier1,P=eb*eF.commissionPerTier2,S=R+F+P+(C=ej*eF.commissionPerJV),T=Array.from({length:12},(e,t)=>Math.min((t+1)/eF.gmvRampMonths,1)).reduce((e,t)=>e+t,0)/12,k=ep*eF.franchiseFee,V=eg*eF.tier1Price+eb*eF.tier2Price+ej*eF.jvPrice+ep*eF.franchiseMembershipPrice,J=(A=ep*eF.gmvPerFranchiseMonthly*12*T+ej*eF.gmvPerJVMonthly*12*T)*eF.royaltyRate,E=k+12*V+J+(O=A*eF.materialPctOfGMV*eF.materialAdoptionRate*eF.materialMarkup),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"If you sell this many in a year, here's what you'll earn and what it generates:"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Franchises"}),(0,t.jsx)("input",{type:"number",min:0,value:ep,onChange:e=>eu(parseInt(e.target.value)||0),className:"w-full text-xs border border-gray-300 rounded-lg px-2 py-1.5 text-right focus:ring-2 focus:ring-green-500 outline-none mt-0.5"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Tier 1"}),(0,t.jsx)("input",{type:"number",min:0,value:eg,onChange:e=>ef(parseInt(e.target.value)||0),className:"w-full text-xs border border-gray-300 rounded-lg px-2 py-1.5 text-right focus:ring-2 focus:ring-green-500 outline-none mt-0.5"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Tier 2"}),(0,t.jsx)("input",{type:"number",min:0,value:eb,onChange:e=>ev(parseInt(e.target.value)||0),className:"w-full text-xs border border-gray-300 rounded-lg px-2 py-1.5 text-right focus:ring-2 focus:ring-green-500 outline-none mt-0.5"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"JV"}),(0,t.jsx)("input",{type:"number",min:0,value:ej,onChange:e=>ey(parseInt(e.target.value)||0),className:"w-full text-xs border border-gray-300 rounded-lg px-2 py-1.5 text-right focus:ring-2 focus:ring-green-500 outline-none mt-0.5"})]})]}),(0,t.jsxs)("div",{className:"bg-green-100 rounded-lg p-3 space-y-2 text-xs",children:[(0,t.jsx)("p",{className:"font-bold text-green-900 text-sm",children:"Your Commission Earnings:"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-1 text-green-800",children:[(0,t.jsxs)("span",{children:["Franchises (",ep," Ã— ",B(eF.commissionPerFranchise),")"]}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(R)}),(0,t.jsxs)("span",{children:["Tier 1 (",eg," Ã— ",B(eF.commissionPerTier1),")"]}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(F)}),(0,t.jsxs)("span",{children:["Tier 2 (",eb," Ã— ",B(eF.commissionPerTier2),")"]}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(P)}),(0,t.jsxs)("span",{children:["JV (",ej," Ã— ",B(eF.commissionPerJV),")"]}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(C)})]}),(0,t.jsxs)("div",{className:"border-t border-green-300 pt-2 flex justify-between",children:[(0,t.jsx)("span",{className:"font-bold text-green-900",children:"Total Commission:"}),(0,t.jsx)("span",{className:"font-bold text-green-900 text-lg",children:B(S)})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 space-y-2 text-xs",children:[(0,t.jsx)("p",{className:"font-bold text-blue-900 text-sm",children:"What This Generates for HQ (Year 1):"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-1 text-blue-800",children:[(0,t.jsx)("span",{children:"Franchise fees (upfront)"}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(k)}),(0,t.jsx)("span",{children:"Recurring memberships/yr"}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(12*V)}),(0,t.jsx)("span",{children:"Royalties/yr (on GMV)"}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(J)}),(0,t.jsx)("span",{children:"Material markup/yr"}),(0,t.jsx)("span",{className:"text-right font-bold",children:B(O)})]}),(0,t.jsxs)("div",{className:"border-t border-blue-300 pt-2 flex justify-between",children:[(0,t.jsx)("span",{className:"font-bold text-blue-900",children:"Total HQ Revenue (Y1):"}),(0,t.jsx)("span",{className:"font-bold text-blue-900 text-lg",children:B(E)})]}),E>0&&(0,t.jsxs)("p",{className:"text-blue-600 italic mt-1",children:["Commission cost is ",(S/E*100).toFixed(1),"% of Y1 revenue â€” ",S/E<.1?"very efficient":S/E<.2?"reasonable":"watch this ratio"]}),eF.gmvRampMonths>1&&(0,t.jsxs)("p",{className:"text-blue-500 italic mt-1",children:["GMV adjusted for ",eF.gmvRampMonths,"-month ramp (avg ",(100*T).toFixed(0),"% of steady state in Y1)"]})]})]}))})]})]}),"compare"===D&&(0,t.jsxs)("div",{className:"space-y-4 overflow-hidden",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-hidden",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Scenario Comparison"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-xs",style:{minWidth:400},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b-2 whitespace-nowrap",children:[(0,t.jsx)("th",{className:"text-left py-2 pr-2",children:"Metric"}),eP.map((e,a)=>(0,t.jsx)("th",{className:"text-right py-2 px-2 max-w-[120px]",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1 truncate",children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"truncate",children:e.name})]})},a))]})}),(0,t.jsx)("tbody",{children:[{label:"Total Revenue",get:e=>Y(e.totalRevenue)},{label:"Total Profit",get:e=>Y(e.totalProfit)},{label:"End Mbrs (T1+T2)",get:e=>e.lastRow.activeTier1+e.lastRow.activeTier2},{label:"End JV Partners",get:e=>e.lastRow.activeJV},{label:"End Franchises",get:e=>e.lastRow.activeFranchises},{label:"Recurring/Mo",get:e=>U(e.lastRow.revMembership)},{label:"GMV/Mo (end)",get:e=>U(e.lastRow.systemGMV)},{label:"Break-Even",get:e=>e.breakEvenMonth>=0?"Mo "+(e.breakEvenMonth+1):"Never"},{label:"Avg Mo Profit",get:e=>U(e.totalProfit/e.rows.length)}].map(e=>(0,t.jsxs)("tr",{className:"border-b whitespace-nowrap",children:[(0,t.jsx)("td",{className:"py-2 pr-2 font-medium text-gray-600",children:e.label}),eE.map((a,r)=>(0,t.jsx)("td",{className:"text-right py-2 px-2 font-medium",children:e.get(a)},r))]},e.label))})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-hidden",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Cumulative Profit Overlay"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:300,children:(0,t.jsxs)(u.ComposedChart,{children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:5,angle:-45,textAnchor:"end",height:50,allowDuplicatedCategory:!1}),(0,t.jsx)(i.YAxis,{tickFormatter:U,tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)}),(0,t.jsx)(o.Legend,{wrapperStyle:{fontSize:11}}),(0,t.jsx)($,{y:0,stroke:"#999",strokeDasharray:"3 3"}),eE.map((e,a)=>(0,t.jsx)(g.Line,{data:e.rows,dataKey:"cumProfit",name:eP[a].name,stroke:eP[a].color,strokeWidth:2.5,dot:!1},a))]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-hidden",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Monthly Revenue Overlay"}),(0,t.jsx)(c.ResponsiveContainer,{width:"100%",height:250,children:(0,t.jsxs)(u.ComposedChart,{children:[(0,t.jsx)(n.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,t.jsx)(s.XAxis,{dataKey:"month",tick:{fontSize:9},interval:5,angle:-45,textAnchor:"end",height:50,allowDuplicatedCategory:!1}),(0,t.jsx)(i.YAxis,{tickFormatter:U,tick:{fontSize:10}}),(0,t.jsx)(l.Tooltip,{formatter:e=>B(e)}),(0,t.jsx)(o.Legend,{wrapperStyle:{fontSize:11}}),eE.map((e,a)=>(0,t.jsx)(g.Line,{data:e.rows,dataKey:"totalRevenue",name:eP[a].name,stroke:eP[a].color,strokeWidth:2,dot:!1},a))]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex flex-wrap justify-between items-start gap-3 mb-4",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800",children:"Valuation Calculator"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Trailing 12-month EBITDA at sale date Ã— multiple"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-purple-50 rounded-lg px-3 py-2 border border-purple-200",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-purple-700 whitespace-nowrap",children:"Sale Year:"}),(0,t.jsx)("select",{value:eM,onChange:e=>eR(parseInt(e.target.value)),className:"text-sm font-bold border border-purple-300 rounded px-2 py-1 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none bg-white",children:Array.from({length:11},(e,t)=>2026+t).map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-indigo-50 rounded-lg px-3 py-2 border border-indigo-200",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-indigo-700 whitespace-nowrap",children:"EBITDA Multiple:"}),(0,t.jsx)("input",{type:"number",min:1,max:30,step:.5,value:eN,onChange:e=>ew(parseFloat(e.target.value)||5),className:"w-16 text-center text-sm font-bold border border-indigo-300 rounded px-2 py-1 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"}),(0,t.jsx)("span",{className:"text-xs text-indigo-600 font-medium",children:"x"})]})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${eP.length}, minmax(160px, 1fr))`},children:eP.map((e,a)=>{let r,s=eE[a],i=s.years[s.years.length-1]?.year??2030,n=eM>i;if(n)r=function(e,t,a,r){if(r<=a)return 0;let{activeFranchises:s,activeJV:i,activeTier1:n,activeTier2:l}=t,o=X(e.churnRateFranchise),c=X(e.churnRateJV),d=X(e.churnRateTier1),h=X(e.churnRateTier2),x=(r-a)*12,m=[];for(let t=0;t<x;t++){s=Math.max(0,s-Math.floor(s*o)),i=Math.max(0,i-Math.floor(i*c)),n=Math.max(0,n-Math.floor(n*d)),l=Math.max(0,l-Math.floor(l*h));let t=s*e.gmvPerFranchiseMonthly+i*e.gmvPerJVMonthly,a=n*e.tier1Price+l*e.tier2Price+i*e.jvPrice+s*e.franchiseMembershipPrice+t*e.royaltyRate+t*e.platformFeeRate+t*e.materialPctOfGMV*e.materialAdoptionRate*e.materialMarkup-Z(e,s,i,n,l);m.push(a)}return m.slice(-12).reduce((e,t)=>e+t,0)}(eF,s.lastRow,i,eM);else{let e=s.years.find(e=>e.year===eM);r=e?.profit??0}let l=s.years[s.years.length-1],o=l?.profit??0,c=r*(eN-1),d=r*eN,h=r*(eN+1),x=s.lastRow.activeFranchises,m=s.lastRow.activeJV;if(n){let e=X(eF.churnRateFranchise),t=X(eF.churnRateJV);for(let a=0;a<(eM-i)*12;a++)x=Math.max(0,x-Math.floor(x*e)),m=Math.max(0,m-Math.floor(m*t))}return(0,t.jsxs)("div",{className:"rounded-lg border-2 p-2 overflow-hidden",style:{borderColor:e.color+"40"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 mb-2 min-w-0",children:[(0,t.jsx)("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"font-bold text-xs text-gray-800 truncate",children:e.name})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"text-[11px] text-gray-500",children:[(0,t.jsxs)("div",{className:"font-medium text-gray-700",children:[eM," EBITDA: ",(0,t.jsx)("span",{className:"font-bold text-gray-800",children:U(r)})]}),n&&(0,t.jsx)("span",{className:"text-[10px] text-purple-600",children:"(projected)"})]}),n&&(0,t.jsxs)("div",{className:"text-[9px] text-gray-400 leading-tight",children:[(0,t.jsxs)("div",{children:["vs ",i,": ",U(o)," ",r>o?"ðŸ“ˆ":r<o?"ðŸ“‰":"â†’"," ",r!==o?((r/o-1)*100).toFixed(0)+"%":"flat"]}),(0,t.jsxs)("div",{children:[x,"F Â· ",m,"JV at sale"]})]}),(0,t.jsxs)("div",{className:"border-t pt-1.5 space-y-1",children:[(0,t.jsxs)("div",{className:"rounded-md bg-amber-50 border border-amber-200 px-2 py-1.5",children:[(0,t.jsx)("div",{className:"text-[9px] font-medium text-amber-700 uppercase tracking-wide",children:"Conservative"}),(0,t.jsx)("div",{className:"text-sm font-bold text-amber-700",children:Y(c)}),(0,t.jsxs)("div",{className:"text-[9px] text-amber-500",children:[U(r)," Ã— ",(eN-1).toFixed(1),"x"]})]}),(0,t.jsxs)("div",{className:"rounded-md bg-blue-50 border border-blue-200 px-2 py-1.5",children:[(0,t.jsx)("div",{className:"text-[9px] font-medium text-blue-700 uppercase tracking-wide",children:"Average"}),(0,t.jsx)("div",{className:"text-sm font-bold text-blue-700",children:Y(d)}),(0,t.jsxs)("div",{className:"text-[9px] text-blue-500",children:[U(r)," Ã— ",eN.toFixed(1),"x"]})]}),(0,t.jsxs)("div",{className:"rounded-md bg-green-50 border border-green-200 px-2 py-1.5",children:[(0,t.jsx)("div",{className:"text-[9px] font-medium text-green-700 uppercase tracking-wide",children:"High"}),(0,t.jsx)("div",{className:"text-sm font-bold text-green-700",children:Y(h)}),(0,t.jsxs)("div",{className:"text-[9px] text-green-500",children:[U(r)," Ã— ",(eN+1).toFixed(1),"x"]})]})]})]})]},a)})})}),eM>(eE[0]?.years[eE[0].years.length-1]?.year??2030)&&(0,t.jsx)("p",{className:"text-[10px] text-gray-400 mt-3 italic",children:"Projection assumes no new sales after model period. Locations fully ramped. Churn continues."})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-4 shadow-sm overflow-hidden",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-800 mb-3",children:"Annual P&L by Scenario"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-xs whitespace-nowrap",style:{minWidth:700},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b-2 border-gray-300",children:[(0,t.jsx)("th",{className:"text-left py-2 px-2",children:"Scenario"}),(0,t.jsx)("th",{className:"text-left py-2 px-2",children:"Year"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Fran Fees"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Mbr"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Royalty"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 text-orange-700",children:"Matl"}),(0,t.jsx)("th",{className:"text-right py-2 px-1",children:"Platform"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 font-bold bg-green-50",children:"Revenue"}),(0,t.jsx)("th",{className:"text-right py-2 px-1 font-bold bg-red-50",children:"Cost"}),(0,t.jsx)("th",{className:"text-right py-2 px-2 font-bold",children:"Profit"})]})}),(0,t.jsx)("tbody",{children:eP.map((e,a)=>eE[a].years.map((r,s)=>(0,t.jsxs)("tr",{className:`border-b ${0===s&&a>0?"border-t-2 border-gray-400":""}`,children:[0===s&&(0,t.jsx)("td",{rowSpan:eE[a].years.length,className:"py-2 px-2 font-bold align-top max-w-[100px]",children:(0,t.jsxs)("div",{className:"flex items-center gap-1 truncate",children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"truncate",children:e.name})]})}),(0,t.jsx)("td",{className:"py-2 px-2 font-medium",children:r.year}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(r.franchiseFees)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(r.membership)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(r.royalties)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 text-orange-600",children:U(r.materialMarkup)}),(0,t.jsx)("td",{className:"text-right py-2 px-1",children:U(r.platformFees)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 font-bold bg-green-50",children:U(r.revenue)}),(0,t.jsx)("td",{className:"text-right py-2 px-1 font-bold bg-red-50",children:U(r.cost)}),(0,t.jsx)("td",{className:`text-right py-2 px-2 font-bold ${r.profit>=0?"text-green-700":"text-red-700"}`,children:U(r.profit)})]},`${a}-${s}`)))})]})})]})]})]})]})}e.s(["default",()=>er],41990)}]);